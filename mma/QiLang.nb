(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12614,        400]
NotebookOptionsPosition[     10932,        339]
NotebookOutlinePosition[     11271,        354]
CellTagsIndexPosition[     11228,        351]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.732435490053124*^9, 3.732435497166171*^9}, {
  3.732512648756961*^9, 3.732512651027521*^9}, {3.73251336272132*^9, 
  3.732513364389949*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Basic", " ", "data", " ", "structures"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.732435648285994*^9, 3.732435658274324*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"*", " ", "Qudits", " ", "and", " ", "qubits"}], " ", 
  "**)"}]], "Input",
 CellChangeTimes->{{3.732435538159339*^9, 3.732435585427601*^9}, {
  3.732435616839052*^9, 3.732435616940593*^9}, {3.732435661654868*^9, 
  3.732435703117844*^9}, {3.732438208208458*^9, 3.7324382122938347`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qudit", "[", 
   RowBox[{"d_Integer", ",", "k_Integer"}], "]"}], ":=", 
  RowBox[{"QInt", "[", 
   RowBox[{"UnitVector", "[", 
    RowBox[{"d", ",", 
     RowBox[{"k", "+", "1"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7325139962576647`*^9, 3.732514015422934*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qubit", "[", "k_Integer", "]"}], ":=", 
  RowBox[{"qudit", "[", 
   RowBox[{"2", ",", "k"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Basic", " ", "gates"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.732435775626952*^9, 3.7324357759892387`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"not", "[", "d_Integer", "]"}], ":=", 
  RowBox[{"QGate", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"UnitVector", "[", 
       RowBox[{"d", ",", "#"}], "]"}], "&"}], ",", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"2", ",", "d"}], "]"}], "~", "Join", "~", 
      RowBox[{"{", "1", "}"}]}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.732435049370915*^9, 3.73243505960028*^9}, {
  3.732435162099069*^9, 3.732435185603758*^9}, {3.7324354012685223`*^9, 
  3.732435401472303*^9}, {3.7324354647775517`*^9, 3.732435465322447*^9}, {
  3.732435713737915*^9, 3.732435715425693*^9}, {3.732436006849238*^9, 
  3.7324360199101133`*^9}, {3.732436813222681*^9, 3.732436836674986*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qft", "[", "d_Integer", "]"}], ":=", 
  RowBox[{"QGate", "[", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "\[Omega]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Omega]", "=", 
       RowBox[{"Exp", "[", 
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"I", "/", "d"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", "d", "]"}]}], " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\[Omega]", "^", 
          RowBox[{"(", 
           RowBox[{"i", " ", "k"}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", 
           RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.732437784934366*^9, 3.732437826581789*^9}, {
  3.732437882809413*^9, 3.732437892505828*^9}, {3.7324379371639833`*^9, 
  3.732437940407695*^9}, {3.732438041939446*^9, 3.732438066965061*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"*", " ", "Quantum", " ", "interpreter"}], " ", "**)"}]], "Input",
 CellChangeTimes->{{3.732438234036165*^9, 3.732438238876095*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"QRun", "[", 
   RowBox[{"g_QGate", ",", "r_QInt"}], "]"}], ":=", 
  RowBox[{"QInt", "[", 
   RowBox[{
    RowBox[{"g", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ".", 
    RowBox[{"r", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.732436888675305*^9, 3.732436920373822*^9}, {
  3.7324380783140783`*^9, 3.732438081359447*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QRun", "[", 
  RowBox[{
   RowBox[{"not", "[", "2", "]"}], ",", 
   RowBox[{"qudit", "[", 
    RowBox[{"2", ",", "1"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7324369216697206`*^9, 3.732436937441958*^9}, {
  3.732437125574977*^9, 3.7324371315957727`*^9}}],

Cell[BoxData["\<\"QInt -> |{1, 0}>\"\>"], "Output",
 CellChangeTimes->{{3.732436934573667*^9, 3.732436937995657*^9}, {
   3.732437128389482*^9, 3.7324371318723993`*^9}, 3.732438082643062*^9, 
   3.7324382427972527`*^9, 3.732513396642976*^9, 3.732513832972569*^9, 
   3.7325140199931173`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"*", " ", "Fake", " ", "quantum", " ", "computer"}], " ", 
  "**)"}]], "Input",
 CellChangeTimes->{{3.732513919549642*^9, 3.732513926235384*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$PrePrint", "=", 
   RowBox[{
    RowBox[{"Switch", "[", 
     RowBox[{
      RowBox[{"Head", "[", "#", "]"}], ",", "\[IndentingNewLine]", "QInt", 
      ",", " ", 
      RowBox[{"\"\<QInt: |\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<>\>\""}], ",", 
      "\[IndentingNewLine]", "QGate", ",", " ", 
      RowBox[{"MatrixForm", "[", 
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", "]"}],
     "&"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.732512653212735*^9, 3.732512683969479*^9}, {
   3.732512807667473*^9, 3.7325128546488028`*^9}, {3.732512905207158*^9, 
   3.732512912358993*^9}, {3.732513046404539*^9, 3.7325131525353413`*^9}, 
   3.732513195157061*^9, {3.732513237422846*^9, 3.73251324042481*^9}, {
   3.732513482057871*^9, 3.732513544221326*^9}, {3.7325135971004753`*^9, 
   3.732513688403775*^9}, {3.73251388626156*^9, 3.7325138924634657`*^9}, {
   3.732513948822544*^9, 3.732513972856497*^9}, {3.732514041679414*^9, 
   3.732514086809785*^9}, {3.732514209773095*^9, 3.732514251689477*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"not", "[", "2", "]"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1"},
     {"1", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.732513843420608*^9, {3.7325139282869883`*^9, 3.732513965755657*^9}, {
   3.732514045576209*^9, 3.732514088100314*^9}, {3.732514218405654*^9, 
   3.732514253998424*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QRun", "[", 
  RowBox[{
   RowBox[{"qft", "[", "2", "]"}], ",", 
   RowBox[{"qubit", "[", "0", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.732438073296525*^9, 3.732438102995682*^9}}],

Cell[BoxData[
 RowBox[{"QInt", "[", 
  RowBox[{"{", 
   RowBox[{
    FractionBox["1", 
     SqrtBox["2"]], ",", 
    FractionBox["1", 
     SqrtBox["2"]]}], "}"}], "]"}]], "Output",
 CellChangeTimes->{{3.7324380985595303`*^9, 3.73243810326294*^9}, 
   3.732438147785205*^9, 3.732438243544998*^9, 3.732513398151388*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"qubit", "[", "0", "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "\[CircleTimes]", 
  RowBox[{
   RowBox[{"qubit", "[", "0", "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.732438260331791*^9, 3.732438272815112*^9}, {
  3.732438425638259*^9, 3.732438428745016*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"1", ",", "0"}], "}"}], "\[CircleTimes]", 
  RowBox[{"{", 
   RowBox[{"1", ",", "0"}], "}"}]}]], "Output",
 CellChangeTimes->{3.7324382731861477`*^9, 3.732438429091629*^9, 
  3.732513399166789*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"qudit", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "//", "Head"}], ")"}], "\[Equal]", 
  "QInt"}]], "Input",
 CellChangeTimes->{{3.732512734693904*^9, 3.732512755661008*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.732512737738016*^9, 3.7325127561500273`*^9}, 
   3.732512839053432*^9, 3.732513402416277*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"$PrePrint", "=."}]], "Input",
 CellChangeTimes->{{3.732512994271515*^9, 3.732512994555019*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qubit", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.73251298198188*^9, 3.7325130293703203`*^9}}],

Cell[BoxData[
 RowBox[{"QInt", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}], "]"}]], "Output",
 CellChangeTimes->{{3.73251298497624*^9, 3.732513154519429*^9}, {
   3.732513259562215*^9, 3.732513264497252*^9}, 3.732513407883349*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"QIntQ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Head", "[", "#", "]"}], "==", "QInt"}], " ", "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QOpQ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Head", "[", "#", "]"}], "\[Equal]", "QGate"}], "&"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.73251270933504*^9, 3.732512834296175*^9}, {
  3.732512967780295*^9, 3.732512972566568*^9}, {3.732513221431991*^9, 
  3.732513248885844*^9}, {3.73251333278734*^9, 3.7325133544155617`*^9}, {
  3.7325134333864822`*^9, 3.7325134627285147`*^9}, {3.732513551382162*^9, 
  3.732513576721799*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Head", "[", "#1", "]"}], "\[Equal]", "QInt"}], "||", 
   RowBox[{
    RowBox[{"Head", "[", "#1", "]"}], "\[Equal]", "QGate"}]}], 
  "&"}]], "Output",
 CellChangeTimes->{{3.732513456862213*^9, 3.73251346747598*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QObjQ", "[", 
  RowBox[{"qubit", "[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.732513474095091*^9, 3.732513477271429*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.732513477698447*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qubit", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.732513493396113*^9, 3.732513495621222*^9}}],

Cell[BoxData["\<\"QInt->[{0, 1}]\"\>"], "Output",
 CellChangeTimes->{{3.732513496034252*^9, 3.732513534386235*^9}, 
   3.732513689767466*^9}]
}, Open  ]]
},
WindowSize->{808, 911},
WindowMargins->{{Automatic, 417}, {Automatic, 218}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 215, 4, 32, "Input"],
Cell[776, 26, 176, 3, 32, "Input"],
Cell[955, 31, 327, 6, 32, "Input"],
Cell[1285, 39, 310, 8, 32, "Input"],
Cell[1598, 49, 146, 4, 32, "Input"],
Cell[1747, 55, 160, 3, 32, "Input"],
Cell[1910, 60, 755, 17, 32, "Input"],
Cell[2668, 79, 1139, 29, 99, "Input"],
Cell[3810, 110, 172, 3, 32, "Input"],
Cell[3985, 115, 400, 11, 32, "Input"],
Cell[CellGroupData[{
Cell[4410, 130, 288, 7, 32, "Input"],
Cell[4701, 139, 291, 4, 32, "Output"]
}, Open  ]],
Cell[5007, 146, 185, 4, 32, "Input"],
Cell[5195, 152, 1175, 24, 99, "Input"],
Cell[CellGroupData[{
Cell[6395, 180, 56, 1, 32, "Input"],
Cell[6454, 183, 778, 21, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7269, 209, 210, 5, 32, "Input"],
Cell[7482, 216, 318, 9, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7837, 230, 347, 9, 32, "Input"],
Cell[8187, 241, 248, 7, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8472, 253, 239, 7, 32, "Input"],
Cell[8714, 262, 147, 2, 32, "Output"]
}, Open  ]],
Cell[8876, 267, 119, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[9020, 273, 125, 2, 32, "Input"],
Cell[9148, 277, 242, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9427, 287, 638, 17, 55, "Input"],
Cell[10068, 306, 274, 8, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10379, 319, 156, 3, 32, "Input"],
Cell[10538, 324, 73, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10648, 330, 124, 2, 32, "Input"],
Cell[10775, 334, 141, 2, 32, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
